DECLARE LANG
DECLARE L
DECLARE filename
DECLARE CELLOP
DECLARE varTIME
DECLARE a
DECLARE FST_NAME
DECLARE MID_NAME
DECLARE EMPLOYEE,WORD
DECLARE OVERDUE,LONG
DECLARE INN
DECLARE SALE,WORD
DECLARE PRODUCT,WORD
DECLARE BD,WORD
DECLARE COLLECTION_ALERT
DECLARE ASSET_NUM
DECLARE PH
DECLARE sSQL,STRING,""
DECLARE IVRLANGUAGE_CNT,WORD
DECLARE O_REQUEST,WORD
DECLARE PARAM4
DECLARE MODULE
DECLARE LNG_CNT,WORD,0
DECLARE CONTEXT,STRING,ivrlanguage
DECLARE DATE_INSERT
DECLARE CH
DECLARE ACTION
DECLARE BATCH
DECLARE TOKEN
DECLARE QUEUE_ID
DECLARE MESSAGE
DECLARE PHONE_NO
DECLARE STATUS,,0
DECLARE sms_type
DECLARE Account_num
DECLARE trans_date
DECLARE trans_amount,LONG
DECLARE DATEINWORDS
DECLARE DAYINWORDS
DECLARE MONTHINWORDS
DECLARE YEARINWORDS
DECLARE YEAR
DECLARE MONTH
DECLARE DAY
DECLARE MK_SMS,WORD
DECLARE CC_QUEUE
DECLARE WELCOME_LETTER,WORD
DECLARE CURRENTDATE
DECLARE call_cnt
DECLARE VIP


IF ANI==0954709924 TERMINATE
IF ANI==0665480846 TERMINATE
IF ANI==0951870254 TERMINATE
IF ANI==0505330107 TERMINATE
IF ANI==0953671393 TERMINATE
IF ANI==0991947582 TERMINATE
IF ANI==0500536297 TERMINATE
IF ANI==0665723851 TERMINATE
IF ANI==0971852504 TERMINATE
IF ANI==0974003260 TERMINATE
IF ANI==0971852504 TERMINATE
IF ANI==0999411793 TERMINATE
IF ANI==0933615980  TERMINATE
IF ANI==0680047613   TERMINATE
IF ANI==0636611998 TERMINATE
IF ANI==0981255984 TERMINATE
IF ANI==0660862393 TERMINATE
IF ANI==0506378049 TERMINATE
IF ANI==0934829878 TERMINATE
IF ANI==0671115475 TERMINATE
IF ANI==0685723925 TERMINATE
IF ANI==0984142816 TERMINATE
IF ANI==0983855118 TERMINATE
IF ANI==0996506128 TERMINATE
IF ANI==0664004470 TERMINATE
IF ANI==0672776814 TERMINATE
IF ANI==0668541403 TERMINATE
IF ANI==0683789164 TERMINATE
IF ANI==0677554381 TERMINATE
IF ANI==0978675246 TERMINATE
IF ANI==0992092733 TERMINATE
IF ANI==0982357221 TERMINATE
IF ANI==0953021036 TERMINATE
IF ANI==0683789164 TERMINATE
IF ANI==0672776814 TERMINATE


NIGHTSERVICE OUTOFHOURS

DBMS DRIVER=SQL Server;SERVER=imb-mssqlst;DATABASE=Server;UID=mcc;PWD=mcc;
//DBMSDSN DSN=crm,UID=mcc,PWD=mcc,Oracle
DBMSDSN DSN=crm,UID=mcc,PWD=mcc,Oracle
CURRENTDATE CURRENTDATE

CONCAT PH,+38,ANI
LET sSQL="SELECT FST_NAME,MID_NAME,PHONE_NO,EMPLOYEE,OVERDUE,LANG,INN,SALE,PRODUCT,BD,COLLECTION_ALERT,ASSET_NUM,MK_SMS,CC_QUEUE,WELCOME_LETTER FROM table(imb_ivr.SMARTIVR ('#PH#'))"
REPLACE sSQL,#PH#,PH
EXECUTESQL(Oracle) sSQL
CLOSECURSOR(Oracle)
LET sSQL = "select max(X_PTB_VIP_FLG) as VIP from siebel.s_contact CON join SIEBEL.S_PER_COMM_ADDR  addr on con.row_id=addr.PER_ID where ADDR = '#PH#' and addr.X_ACTIVE_FLG = 'Y' "
REPLACE sSQL,#PH#,PH
EXECUTESQL(Oracle) sSQL
CLOSECURSOR(Oracle)
MID ANI,0,3,CELLOP
CURRENTTIME varTIME
LET BATCH=ANI

:CHECK_PHONE
IF PHONE_NO!= GOTO PERSONALIZED
LET sSQL="SELECT O_REQUEST FROM table(imb_ivr.APPLICATION_EXISTS ('#PH#'))"
REPLACE sSQL,#PH#,PH
EXECUTESQL(Oracle) sSQL
CLOSECURSOR(Oracle)
LET MODULE=IVR
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF O_REQUEST==1 GOTO POTENTIAL
//GOTO IVRLANGUAGE
IF VIP==Y GOTO VIP_LANG(a)
SCRIPTTRANSFER ivrlanguage2

:PERSONALIZED
LET L=LANG
IF LANG== GOTO WOLANG(a)
GOTO TIME

:TIME
IF varTIME<12:00:00 GOTO MORNING
IF varTIME<18:00:00 GOTO DAY
IF varTIME>18:00:00 GOTO EVENING

:MORNING

CONCAT filename,new_2_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO NAME

:DAY
CONCAT filename,new_1_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO NAME

:EVENING
CONCAT filename,new_3_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO NAME

:NAME
IF MID_NAME== GOTO NAME1
IF FST_NAME== GOTO NAME1
CONCAT filename,FST_NAME,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,MID_NAME,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT=name
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
GOTO NAME1

:NAME1
CONCAT filename,new_4_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
IF LANG== GOTO IVRLANGUAGE
SELECT count(*) as call_cnt from calltrace where ANI =ANI and INCOMINGCALLTIME > CURRENTDATE
IF call_cnt>0 GOTO NAME2
IF CC_QUEUE!= GOTO CC_QUEUE(a)
IF COLLECTION_ALERT != GOTO COLLECTION_ALERT(a)
IF WELCOME_LETTER==1 GOTO WELCOME_LETTER(a)
IF BD==1 GOTO BD(a)
GOTO NAME2

:NAME2
LET CONTEXT=ivrlanguage
CURRENTDATETIME DATE_INSERT
LET CH=smartIVR
LET ACTION=Autoselect
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF DNIS==8196 GOTO CELLOP(a)
IF VIP== Y GOTO VIP
IF  OVERDUE>1 GOTO COLLECTION_INBOUND
IF EMPLOYEE==1 GOTO SALARY
IF PRODUCT==1 GOTO CARDS_IVR
IF PRODUCT==2 GOTO PREAUTH
IF PRODUCT==3 GOTO MINIIVR
HANGUP

:WOLANG (a)
LET L=UA
RETURN

:VIP_LANG(a)
SETSCRIPTVALUE "MODULENAME","VIP"
SETSCRIPTVALUE "LANGUAGE",LANG
RETURN


:COLLECTION_ALERT (a)
SELECTCURSOR trans_date,trans_amount FROM one_p_dealno(ASSET_NUM,COLLECTION_ALERT)
CLOSECURSOR
IF trans_date!= GOTO COLLECTION_ALERT2(a)
RETURN

:COLLECTION_ALERT2 (a)
LET CONTEXT=ivr_alert
CURRENTDATETIME DATE_INSERT
LET CH=collection_alert
LET ACTION=check
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_17_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_749_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
SAYMONEY trans_amount,d:\MCC\Server\VOX\new_money,LANG
CONCAT filename,new_750_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET DATEINWORDS=trans_date
MID DATEINWORDS,0,4,YEAR
MID DATEINWORDS,5,2,MONTH
MID DATEINWORDS,8,2,DAY
CONCAT DAYINWORDS,d:\MCC\Server\VOX\new_day\,DAY,_,LANG,.vox
CONCAT MONTHINWORDS,d:\MCC\Server\VOX\new_month\,MONTH,_,LANG,.vox
CONCAT YEARINWORDS,d:\MCC\Server\VOX\new_year\,YEAR,_,LANG,.vox
INTERRUPTPLAY DAYINWORDS,FP,0
INTERRUPTPLAY MONTHINWORDS,FP,0
INTERRUPTPLAY YEARINWORDS,FP,0
CONCAT filename,new_748_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
RETURN


:BD (a)
LET CONTEXT=ivr_alert
CURRENTDATETIME DATE_INSERT
LET CH=bd
LET ACTION=check
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_777_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_778_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
RETURN

:WELCOME_LETTER(a)
LET CONTEXT=ivr_alert
CURRENTDATETIME DATE_INSERT
LET CH=letter
LET ACTION=check
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_746_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
RETURN

:CC_QUEUE (a)
LET CONTEXT=ivr_alert
CURRENTDATETIME DATE_INSERT
LET CH=cc_queue
LET ACTION=check
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
LET CONTEXT=
LET CH=
LET ACTION=
IF CC_QUEUE==CC_PTB_Main GOTO CC_SERVICE
IF CC_QUEUE==CC_Salary_Cards GOTO CC_SALARY
IF CC_QUEUE==e-banking GOTO E_BANKING
IF CC_QUEUE==CC_Sales GOTO CC_SALES
IF CC_QUEUE==CC_PTB_Corporate GOTO CORPORATE
IF CC_QUEUE==CC_Mortgage GOTO MORTGAGE

RETURN

:PREAUTH
IF LNG_CNT==1 GOTO PREAUTH1
IF DNIS==8196 GOTO PREAUTH1
GOTO PREAUTH1

:PREAUTH1
SETSCRIPTVALUE "MODULENAME","PREAUTH"
SETSCRIPTVALUE "LANGUAGE",LANG
SETSCRIPTVALUE "XXX",INN
LET MODULE=IVRPREAUTH
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SCRIPTTRANSFER ivrmain2
HANGUP

:SALARY
IF DNIS==8196 GOTO SALARY1
IF LNG_CNT==1 GOTO SALARY1
GOTO SALARY1

:SALARY1
SETSCRIPTVALUE "MODULENAME","SALARY"
SETSCRIPTVALUE "LANGUAGE",LANG
SETSCRIPTVALUE "XXX",INN
LET MODULE=IVRSALARY
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SCRIPTTRANSFER ivrmain2
HANGUP

:VIP
IF DNIS==8196 GOTO VIP1
IF LNG_CNT==1 GOTO VIP1
GOTO VIP1

:VIP1
SETSCRIPTVALUE "MODULENAME","VIP"
SETSCRIPTVALUE "LANGUAGE",LANG
SETSCRIPTVALUE "XXX",INN
LET MODULE=IVRVIP
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SCRIPTTRANSFER ivrmain2
HANGUP


:CARDS_IVR
IF DNIS==8196 GOTO CARDS_IVR1
IF LNG_CNT==1 GOTO CARDS_IVR1
GOTO CARDS_IVR1

:CARDS_IVR1
SETSCRIPTVALUE "MODULENAME","Cards_IVR"
SETSCRIPTVALUE "LANGUAGE",LANG
SETSCRIPTVALUE "XXX",INN
LET MODULE=Cards_IVR
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SCRIPTTRANSFER ivrmain2
HANGUP

:MINIIVR
IF DNIS==8196 GOTO MINIIVR1
IF DNIS==8196 GOTO MINIIVR1
IF LNG_CNT==1 GOTO MINIIVR1
GOTO MINIIVR1

:MINIIVR1
SETSCRIPTVALUE "MODULENAME","MINIIVR"
SETSCRIPTVALUE "LANGUAGE",LANG
LET MODULE=MINIIVR
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SCRIPTTRANSFER ivrmain2
HANGUP

:POTENTIAL
IF VIP==Y GOTO VIP
LET MODULE=IVRPOTENTIAL
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
LET CH=Call
LET ACTION=Answered
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE "MODULENAME","POTENTIAL"
SCRIPTTRANSFER ivrlanguage2
HANGUP

:COLLECTION_INBOUND
LET MODULE=TOCOLLECTION
LET CONTEXT=ivrwelcome
CURRENTDATETIME DATE_INSERT
CONCAT PARAM4,LANG,"_",CONTEXT,"_Coll_Inbound_Z"
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
ADDTOQUEUE Coll.Inbound_Z,Coll.Inbound_Z
SETSCRIPTVALUE "CRMPARAM4",PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
ADDTOQUEUE Coll.Inbound_Z,Coll.Inbound_Z
TRANSFERTOAGENTSYNC Coll.Inbound_Z,30000,RING.VOX,HANGUP
HANGUP

:HANGUP
HANGUP

:3080INFO (a)
CONCAT filename,new_472_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_16_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
RETURN


:CELLOP (a)
IF CELLOP==050 GOTO MTS(a)
IF CELLOP==066 GOTO MTS(a)
IF CELLOP==095 GOTO MTS(a)
IF CELLOP==099 GOTO MTS(a)
IF CELLOP==067 GOTO KS(a)
IF CELLOP==068 GOTO KS(a)
IF CELLOP==096 GOTO KS(a)
IF CELLOP==097 GOTO KS(a)
IF CELLOP==098 GOTO KS(a)
IF CELLOP==039 GOTO KS(a)
IF CELLOP==063 GOTO LIFE(a)
IF CELLOP==093 GOTO LIFE(a)
IF CELLOP==073 GOTO LIFE(a)
RETURN


:MTS (a)
CONCAT filename,new_426_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_62_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_60_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_58_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
IF DNIS==8195 GOTO 3080INFO(a)
RETURN

:KS (a)
CONCAT filename,new_426_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_62_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_61_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_58_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
IF DNIS==8195 GOTO 3080INFO(a)
RETURN

:LIFE (a)
CONCAT filename,new_426_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_62_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
//CONCAT filename,new_59_,L,.vox
CONCAT filename,new_59v2_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_58_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
IF DNIS==8195 GOTO 3080INFO(a)
RETURN

:IVRLANGUAGE
IF DNIS==8196 GOTO CELLOP(a)
IF DNIS==8196 GOTO IVRLANGUAGE3080
IF CELLOP==050 GOTO IVRLANGUAGE3080
IF CELLOP==066 GOTO IVRLANGUAGE3080
IF CELLOP==095 GOTO IVRLANGUAGE3080
IF CELLOP==099 GOTO IVRLANGUAGE3080
IF CELLOP==067 GOTO IVRLANGUAGE3080
IF CELLOP==068 GOTO IVRLANGUAGE3080
IF CELLOP==096 GOTO IVRLANGUAGE3080
IF CELLOP==097 GOTO IVRLANGUAGE3080
IF CELLOP==098 GOTO IVRLANGUAGE3080
IF CELLOP==039 GOTO IVRLANGUAGE3080
IF CELLOP==063 GOTO IVRLANGUAGE3080
IF CELLOP==073 GOTO IVRLANGUAGE3080
IF CELLOP==093 GOTO IVRLANGUAGE3080
LET LNG_CNT=1
GOTO IVRLANGUAGE1

:IVRLANGUAGE1
INCREMENT IVRLANGUAGE_CNT
INTERRUPTPLAY new_5_UA.VOX,,0
INTERRUPTPLAY new_71_UA.vox,,0
INTERRUPTPLAY new_5_RU.vox,,0
INTERRUPTPLAY new_72_RU.vox,,0
GETDIGITS 1,5,5
LET CONTEXT=ivrlanguage
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO UA
IF RESPONSE==2 GOTO RU
IF IVRLANGUAGE_CNT==3 GOTO CC_SERVICE
FULLPLAY new_6_UA.vox
GOTO IVRLANGUAGE1

:IVRLANGUAGE3080
INCREMENT IVRLANGUAGE_CNT
INTERRUPTPLAY new_5_UA.VOX,,0
INTERRUPTPLAY new_71_UA.vox,,0
INTERRUPTPLAY new_5_RU.vox,,0
INTERRUPTPLAY new_72_RU.vox,,0
GETDIGITS 1,5,5
LET CONTEXT=ivrlanguage
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO UA
IF RESPONSE==2 GOTO RU
IF IVRLANGUAGE_CNT==3 TERMINATE
FULLPLAY new_6_UA.vox
GOTO IVRLANGUAGE3080

:UA
SETSCRIPTVALUE "LANGUAGE","UA"
LET LANG=UA
LET L=LANG
LET sSQL="UPDATE siebel.s_contact set PREF_LANG_ID = '1-2M8LO' where SOC_SECURITY_NUM = INN "
EXECUTESQL(Oracle) sSQL
CLOSECURSOR(Oracle)
IF CC_QUEUE!= GOTO CC_QUEUE(a)
IF COLLECTION_ALERT != GOTO COLLECTION_ALERT(a)
//IF MK_SMS==1 GOTO BD(a)
IF WELCOME_LETTER==1 GOTO WELCOME_LETTER(a)
IF BD==1 GOTO BD(a)
IF VIP== Y GOTO VIP
IF  OVERDUE>1 GOTO COLLECTION_INBOUND
IF EMPLOYEE==1 GOTO SALARY
IF PRODUCT==1 GOTO CARDS_IVR
IF PRODUCT==2 GOTO PREAUTH
IF PRODUCT==3 GOTO MINIIVR
GOTO IVRMAIN

:RU
SETSCRIPTVALUE "LANGUAGE","RU"
LET LANG=RU
LET L=LANG
LET sSQL="UPDATE siebel.s_contact set PREF_LANG_ID = '05-M8MO6' where SOC_SECURITY_NUM = INN "
EXECUTESQL(Oracle) sSQL
CLOSECURSOR(Oracle)
IF CC_QUEUE!= GOTO CC_QUEUE(a)
IF COLLECTION_ALERT != GOTO COLLECTION_ALERT(a)
//IF MK_SMS==1 GOTO BD(a)
IF WELCOME_LETTER==1 GOTO WELCOME_LETTER(a)
IF BD==1 GOTO BD(a)
IF VIP== Y GOTO VIP
IF  OVERDUE>1 GOTO COLLECTION_INBOUND
IF EMPLOYEE==1 GOTO SALARY
IF PRODUCT==1 GOTO CARDS_IVR
IF PRODUCT==2 GOTO PREAUTH
IF PRODUCT==3 GOTO MINIIVR
GOTO IVRMAIN

:IVRMAIN
IF VIP== Y GOTO VIP
IF MODULE==SALARY GOTO ivrmain2
IF PRODUCT==1 GOTO CARDS_IVR
IF PRODUCT==2 GOTO PREAUTH
IF PRODUCTS==3 GOTO MINIIVR
SETSCRIPTVALUE "XXX",INN
SCRIPTTRANSFER ivrmain2

:ivrmain2
SCRIPTTRANSFER ivrmain2
HANGUP

:CC_SERVICE
ADDTOQUEUE CC PTB Main,CC PTB Main
CONCAT PARAM4,LANG,"_",CONTEXT,"_CC_PTB_Main"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE "CRMPARAM4",PARAM4
CONCAT filename,new_11_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,,RING.VOX
HANGUP

:CC_SALARY
ADDTOQUEUE CC_Salary_Cards,CC_Salary_Cards
CONCAT PARAM4,LANG,"_",CONTEXT,"_CC_Salary_Cards"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE "CRMPARAM4",PARAM4
CONCAT filename,new_11_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,L,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_Salary_Cards,,RING.VOX
HANGUP

:E_BANKING
ADDTOQUEUE CC e-banking,CC e-banking
CONCAT PARAM4,LANG,".",CONTEXT,".e-banking"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC e-banking,,RING.VOX,
HANGUP


:CC_SALES
ADDTOQUEUE CC_Sales,CC_Sales
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Sales"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_Sales,,RING.VOX
HANGUP


:CORPORATE
ADDTOQUEUE CC PTB Corporate,CC PTB Corporate
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Corporate"
SETSCRIPTVALUE CRMPARAM4,PARAM4
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Corporate,,RING.VOX
HANGUP


:MORTGAGE
ADDTOQUEUE CC_Mortgage,CC_Mortgage
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Mortgage"
SETSCRIPTVALUE CRMPARAM4,PARAM4
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_Mortgage,,RING.VOX
HANGUP


:OUTOFHOURS
SCRIPTTRANSFER ivroutofhours2










































































































































































































































































































