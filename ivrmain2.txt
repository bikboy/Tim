DECLARE LANG,,UA
DECLARE MODULE
DECLARE QUEUE_ID,LONG
DECLARE AVAIL,LONG
DECLARE CONTEXT
DECLARE DATE_INSERT
DECLARE CH
DECLARE ACTION
DECLARE BATCH
DECLARE TOKEN,,0
DECLARE IVRMAIN_CNT,WORD
DECLARE CARDS_CNT,WORD
DECLARE PARAM4
DECLARE filename
DECLARE identifycode
DECLARE CELLOP
DECLARE a
DECLARE sum
DECLARE INN,
DECLARE code
DECLARE currency,LONG
DECLARE INN_CNT,WORD
DECLARE CARD_CNT,WORD
DECLARE INN_LENGTH,WORD
DECLARE EMAILBODY

GETQUEUE QUEUE_ID,ID
LET BATCH=ANI
GETSCRIPTVALUE "LANGUAGE",LANG
GETSCRIPTVALUE "MODULENAME",MODULE
DBMS DRIVER=SQL Server;SERVER=IMB-MSSQLST;DATABASE=Server;UID=mcc;PWD=mcc;
QUEUESNAPSHOT 22,,AVAIL
MID ANI,0,3,CELLOP
IF MODULE==VIP GOTO VIP
IF MODULE==SALARY GOTO SALARY
IF MODULE==Cards_IVR GOTO Cards_IVRMAIN
IF MODULE==mIVR GOTO mIVRMAIN
IF MODULE==AIVR GOTO AIVRMAIN
IF MODULE==PREAUTH GOTO PREAUTH
IF MODULE==MINIIVR GOTO MINIIVR
IF MODULE==POTENTIAL GOTO POTENTIAL
IF AVAIL==0 GOTO NOOP

IF MODULE==IVR GOTO IVRMAIN
IF MODULE==IVR3080 GOTO IVRMAIN

:NOOP
IF MODULE==IVR GOTO IVRMAINNOOP
IF MODULE==IVR3080 GOTO IVRMAINNOOP

:IVRMAIN
IF AVAIL==0 GOTO IVRMAINNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_537_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_234_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_76_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==3 GOTO CARDS_OPERATOR
IF RESPONSE==4 GOTO E_BANKING1
IF RESPONSE==5 GOTO CORPORATE
IF RESPONSE==6 GOTO IVRINFO
IF RESPONSE==9 GOTO PTBMAIN9
IF IVRMAIN_CNT==3 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO IVRMAIN


:IVRMAINOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_75_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==3 GOTO CARDS_OPERATOR
IF RESPONSE==4 GOTO E_BANKING1
IF RESPONSE==5 GOTO CORPORATE
IF RESPONSE==6 GOTO IVRINFO
IF RESPONSE==9 GOTO PTBMAIN9
IF IVRMAIN_CNT==3 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO IVRMAINOP


:IVRMAINNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_537_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_234_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_76_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==3 GOTO CARDS_OPERATOR
IF RESPONSE==4 GOTO E_BANKING1
IF RESPONSE==5 GOTO CORPORATE
IF RESPONSE==6 GOTO IVRINFO
IF IVRMAIN_CNT==3 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO IVRMAIN


:mIVRMAIN
INCREMENT IVRMAIN_CNT
LET CONTEXT="mivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
//INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,main511_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,main2_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,544_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,sale2_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,IVR_phrase_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
//INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO mCARDS
IF RESPONSE==3 GOTO ZASTAVKA
IF IVRMAIN_CNT==3 GOTO MIVR_OP
CONCAT filename,timeout538_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO mIVRMAIN

:AIVRMAIN
INCREMENT IVRMAIN_CNT
LET CONTEXT="aivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,agents_568_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_3_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_569_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_2_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_535_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_4_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,agents_5_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,navi2_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,navi4_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO AGENTS_CUSTOMERS
IF RESPONSE==2 GOTO AGENTS_CUSTOMERS
IF RESPONSE==3 GOTO IVRINN
IF IVRMAIN_CNT==2 GOTO AGENTS_CUSTOMERS
CONCAT filename,timeout538_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO AIVRMAIN

:Cards_IVRMAIN
IF AVAIL==0 GOTO CARDSNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_75_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==2 GOTO CARDS_OPERATOR
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==3 GOTO CC_SALES
IF  RESPONSE==4 GOTO E_BANKING1
IF RESPONSE==5 GOTO IVRINFO
IF RESPONSE==9 GOTO PTBMAIN9
IF IVRMAIN_CNT==2 GOTO CARDS_OPERATOR
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO Cards_IVRMAIN

:CARDSNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_75_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==2 GOTO CARDS_OPERATOR
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==3 GOTO CC_SALES
IF  RESPONSE==4 GOTO E_BANKING1
IF RESPONSE==5 GOTO IVRINFO
IF IVRMAIN_CNT==2 GOTO CARDS_OPERATOR
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO CARDSNOOP


:SALARY
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_428_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==2 GOTO SALARY_OP
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==3 GOTO E_BANKING1
IF  RESPONSE==4 GOTO CC_SALES
IF IVRMAIN_CNT==2 GOTO CARDS_OPERATOR
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO SALARY

:VIP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain_VIP"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_230_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO CARD_INN_VIP
IF RESPONSE==2 GOTO VIP_OP
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO VIP

:PREAUTH
IF AVAIL==0 GOTO PREAUTHNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==3 GOTO IVRINFO
IF RESPONSE==9 GOTO PTBMAIN9
IF IVRMAIN_CNT==2 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO PREAUTH

:PREAUTHNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==3 GOTO IVRINFO
IF IVRMAIN_CNT==2 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO PREAUTHNOOP


:MINIIVR
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==3 GOTO IVRINFO
IF RESPONSE==9 GOTO PTBMAIN9_MINI
IF IVRMAIN_CNT==2 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO MINIIVR


:POTENTIAL
IF AVAIL==0 GOTO POTENTIALNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_75_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_79_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==3 GOTO IVRINFO
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==4 GOTO CARDS_OPERATOR
IF RESPONSE==5 GOTO E_BANKING1
IF RESPONSE==9 GOTO PTBMAIN9
IF IVRMAIN_CNT==2 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO POTENTIAL

:POTENTIALNOOP
INCREMENT IVRMAIN_CNT
LET CONTEXT="ivrmain"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_29_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_7_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_243_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_73_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_236_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_511_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_74_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_522_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_75_,LANG,.VOX
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,10,10
CURRENTDATETIME DATE_INSERT
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==2 GOTO CC_SALES
IF RESPONSE==1 GOTO IVRINN
IF RESPONSE==3 GOTO IVRINFO
IF RESPONSE==7 GOTO CARD_INN
IF RESPONSE==4 GOTO CARDS_OPERATOR
IF RESPONSE==5 GOTO E_BANKING1
IF IVRMAIN_CNT==2 GOTO CC_SERVICE
CONCAT filename,new_6_,LANG,.vox
FULLPLAY filename
LET filename=
GOTO POTENTIALNOOP

:IVRINN
SETSCRIPTVALUE MODULENAME,MODULE
SETSCRIPTVALUE LANGUAGE,LANG
GETSCRIPTVALUE "XXX",identifycode
SETSCRIPTVALUE XXX,identifycode
SCRIPTTRANSFER ivrselfcare2
HANGUP

:IVRSALES
SETSCRIPTVALUE MODULENAME,MODULE
SETSCRIPTVALUE LANGUAGE,LANG
SCRIPTTRANSFER ivrsales2
HANGUP

:IVRINFO
SETSCRIPTVALUE MODULENAME,MODULE
SETSCRIPTVALUE LANGUAGE,LANG
SCRIPTTRANSFER ivrinfo2
HANGUP

:CARDS
INCREMENT CARDS_CNT
CONCAT filename,ostatok_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_230_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_428_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,3,5,#
IF RESPONSE==1 GOTO CARDS_OPERATOR
IF RESPONSE==2 GOTO CARDS_OPERATOR
IF CARDS_CNT==2 GOTO CARDS_OPERATOR
CONCAT filename,timeout538_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARDS

:mCARDS
INCREMENT CARDS_CNT
CONCAT filename,ostatok_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_230_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_428_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,3,5,#
IF RESPONSE==1 GOTO mCARDS_OPERATOR
IF RESPONSE==2 GOTO mCARDS_OPERATOR
IF CARDS_CNT==2 GOTO mCARDS_OPERATOR
CONCAT filename,timeout538_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARDS

:E_BANKING
INCREMENT CARDS_CNT
LET CONTEXT="ib_client"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_523_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_526_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CH=Context
LET ACTION=End
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
ADDTOQUEUE CC e-banking,CC e-banking
GETDIGITS 1,5,5
LET CONTEXT="e-banking"
LET CH=Options
LET ACTION=RESPONSE
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO E_BANKING1
IF RESPONSE==2 GOTO E_BANKING1
IF RESPONSE==* GOTO E_BANKING
IF RESPONSE==# GOTO IVRMAIN
IF CARDS_CNT==2 GOTO CC_SERVICE
GOTO E_BANKING

:ZASTAVKA
CONCAT filename,new_322_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
HANGUP


:PTBMAIN9
IF ANI==0982357221 GOTO DELAY(a)
IF ANI==0992092733 GOTO DELAY(a)
IF ANI==0961719777 GOTO DELAY(a)
ADDTOQUEUE CC PTB Main,CC PTB Main
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Main"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
LET CONTEXT="ivrtooperator"
LET CH=Call
LET ACTION=Call Center
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,20000,RING.VOX,SELFCAREADVERTISE
HANGUP

:PTBMAIN9_1
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,,RING.VOX
HANGUP

:SELFCAREADVERTISE
LET CONTEXT="ivr-in-queue"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_744_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_745_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
LET CONTEXT="ivr-in-queue"
LET CH=Options
LET ACTION=RESPONSE
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
GOTO PTBMAIN9_1

:SELFCAREADVERTISESERVICE
LET CONTEXT="ivr-in-queue"
LET CH=Context
LET ACTION=Begin
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_744_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_745_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
LET CONTEXT="ivr-in-queue"
LET CH=Options
LET ACTION=RESPONSE
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==1 GOTO IVRINN
GOTO CC_SERVICE1

:PTBMAIN9_MINI
IF ANI==0982357221 GOTO DELAY(a)
IF ANI==0992092733 GOTO DELAY(a)
IF ANI==0961719777 GOTO DELAY(a)
ADDTOQUEUE CC PTB Main,CC PTB Main
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Main"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
LET CONTEXT=ivrtooperator
LET CH=Call
LET ACTION=Call Center
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,,RING.VOX,
HANGUP

:CC_SERVICE
IF ANI==0982357221 GOTO DELAY(a)
IF ANI==0992092733 GOTO DELAY(a)
IF ANI==0961719777 GOTO DELAY(a)
ADDTOQUEUE CC PTB Main,CC PTB Main
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Main"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,20000,RING.VOX,SELFCAREADVERTISESERVICE
HANGUP


:CC_SERVICE1
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,,RING.VOX
HANGUP

:CARDS_OPERATOR
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Main"
LET CONTEXT=ivrtooperator
LET CH=PARAM4
LET ACTION=ToOperator
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
SETSCRIPTVALUE CRMPARAM4,PARAM4
ADDTOQUEUE CC PTB Main,CC PTB Main
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,20000,RING.VOX,DOCUMENTS
HANGUP


:mCARDS_OPERATOR
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Main"
LET CONTEXT="mivrtooperator"
LET CH=PARAM4
LET ACTION=ToOperator
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
SETSCRIPTVALUE CRMPARAM4,PARAM4
ADDTOQUEUE CC PTB Main,CC PTB Main
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,20000,RING.VOX,DOCUMENTS
HANGUP

:CARDS_OPERATOR1
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Main,,RING.VOX
HANGUP

:DOCUMENTS
CONCAT filename,new_412_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_420_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_417_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARDS_OPERATOR1

:E_BANKING1
ADDTOQUEUE CC e-banking,CC e-banking
CONCAT PARAM4,LANG,".",CONTEXT,".e-banking"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC e-banking,20000,RING.VOX,DOCUMENTS
HANGUP

:MIVR_OP
ADDTOQUEUE CC Manager IVR,CC Manager IVR
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Manager_IVR"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC Manager IVR,,RING.VOX
HANGUP

:AGENTS_CUSTOMERS
ADDTOQUEUE CC Agents Customers,CC Agents Customers
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Agents_Customers"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC Agents Customers,,RING.VOX
HANGUP

:CC_SALES
ADDTOQUEUE CC_Sales,CC_Sales
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Sales"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_Sales,,RING.VOX
HANGUP

:SALARY_OP
ADDTOQUEUE CC_Salary_Cards,CC_Salary_Cards
CONCAT PARAM4,LANG,".",CONTEXT,".CC_Salary_Cards"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_Salary_Cards,,RING.VOX
HANGUP


:CORPORATE
ADDTOQUEUE CC PTB Corporate,CC PTB Corporate
CONCAT PARAM4,LANG,".",CONTEXT,".CC_PTB_Corporate"
SETSCRIPTVALUE CRMPARAM4,PARAM4
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC PTB Corporate,,RING.VOX
HANGUP


:DELAY (a)
FULLPLAYAMBIENT MUSIC.VOX
SLEEP 300000
RETURN


:CARD_INN
INCREMENT INN_CNT
CONCAT filename,new_8_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 10,15,15
LET INN=RESPONSE
LEN RESPONSE,INN_LENGTH
IF INN_LENGTH==10 GOTO CARD_NUM
IF INN_CNT==3 GOTO CC_SERVICE
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_INN

:CARD_NUM
INCREMENT CARD_CNT
CONCAT filename,new_504_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 4,15,15
LET code=RESPONSE
LET INN_LENGTH=
LEN RESPONSE,INN_LENGTH
IF INN_LENGTH==4 GOTO CARD_BALANCE
IF CARD_CNT==3 GOTO CC_SERVICE
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_NUM


:CARD_BALANCE
SELECTCURSOR sum FROM GetCardSum(INN,code)
CLOSECURSOR
FINDSTRING sum,"error",0,currency
IF currency!=-1 GOTO WRONG_CARD
FINDSTRING sum,"UAH",0,currency
IF currency==-1 GOTO DOLLAR_BALANCE
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID,sum)
TRIM L,sum,"/UAH"
SAYMONEY sum,d:\MCC\Server\VOX\new_money,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
IF RESPONSE==* GOTO CARD_BALANCE
IF RESPONSE==# GOTO IVRMAIN
HANGUP



:DOLLAR_BALANCE
FINDSTRING sum,"USD",0,currency
IF currency==-1 GOTO EURO_BALANCE
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID,sum)
TRIM L,sum,"/USD"
SAYMONEY sum,d:\MCC\Server\VOX\new_money_dol,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
IF RESPONSE==* GOTO CARD_BALANCE
IF RESPONSE==# GOTO IVRMAIN
HANGUP


:EURO_BALANCE
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID,sum)
TRIM L,sum,"/EUR"
SAYMONEY sum,d:\MCC\Server\VOX\new_money_eur,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
IF RESPONSE==* GOTO CARD_BALANCE
IF RESPONSE==# GOTO IVRMAIN
HANGUP

:WRONG_CARD
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_INN


:CARD_INN_VIP
INCREMENT INN_CNT
CONCAT filename,new_8_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 10,15,15
LET INN=RESPONSE
LEN RESPONSE,INN_LENGTH
IF INN_LENGTH==10 GOTO CARD_NUM_VIP
IF INN_CNT==3 GOTO VIP_OP
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_INN_VIP

:CARD_NUM_VIP
INCREMENT CARD_CNT
CONCAT filename,new_504_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 4,15,15
LET code=RESPONSE
LET INN_LENGTH=
LEN RESPONSE,INN_LENGTH
IF INN_LENGTH==4 GOTO CARD_BALANCE_VIP
IF CARD_CNT==3 GOTO VIP_OP
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_NUM_VIP


:CARD_BALANCE_VIP
CONCAT filename,new_242_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
SELECTCURSOR sum FROM GetCardSum(INN,code)
CLOSECURSOR
FINDSTRING sum,"error",0,currency
IF currency!=-1 GOTO WRONG_CARD_VIP
FINDSTRING sum,"UAH",0,currency
IF currency==-1 GOTO DOLLAR_BALANCE_VIP
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance_VIP"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID)
TRIM L,sum,"/UAH"
SAYMONEY sum,d:\MCC\Server\VOX\new_money,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
LET CONTEXT="card_balance_VIP"
LET CH="Options"
LET ACTION=RESPONSE
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
IF RESPONSE==* GOTO CARD_BALANCE_VIP
IF RESPONSE==# GOTO VIP
IF RESPONSE==2 GOTO VIP_OP
HANGUP



:DOLLAR_BALANCE_VIP
FINDSTRING sum,"USD",0,currency
IF currency==-1 GOTO EURO_BALANCE_VIP
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID)
TRIM L,sum,"/USD"
SAYMONEY sum,d:\MCC\Server\VOX\new_money_dol,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
IF RESPONSE==* GOTO CARD_BALANCE_VIP
IF RESPONSE==# GOTO VIP
IF RESPONSE==2 GOTO VIP_OP
GETDIGITS 1,5,5
HANGUP


:EURO_BALANCE_VIP
CONCAT filename,balans_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
LET CONTEXT="card_balance"
LET CH="Message"
LET ACTION="End"
CURRENTDATETIME DATE_INSERT
INSERT() INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
INSERT() INTO Cardbalance_log(DATE_INSERT,INN,code,ANI,CALLTRACEID)
TRIM L,sum,"/EUR"
SAYMONEY sum,d:\MCC\Server\VOX\new_money_eur,LANG
CONCAT filename,new_28_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_241_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_248_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_240_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_245_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_72_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,5,5
IF RESPONSE==* GOTO CARD_BALANCE_VIP
IF RESPONSE==# GOTO VIP
IF RESPONSE==2 GOTO VIP_OP
GETDIGITS 1,5,5
HANGUP

:WRONG_CARD_VIP
CONCAT filename,new_12_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO CARD_INN_VIP

:VIP_OP
ADDTOQUEUE CC_VIP,CC_VIP
CONCAT PARAM4,LANG,".",CONTEXT,".CC_VIP"
CURRENTDATETIME DATE_INSERT
LET CH=PARAM4
LET ACTION=ToOperator
INSERT () INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
SETSCRIPTVALUE CRMPARAM4,PARAM4
CONCAT filename,new_11_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_14_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
FULLPLAYAMBIENT MUSIC.VOX
TRANSFERTOAGENTSYNC CC_VIP,30000,RING.VOX,NOONE
HANGUP

:SENDMAIL
CONCAT EMAILBODY,call back client on phone no ,  ANI, he called at , CALLTIME,.
SENDEMAIL mail.imb.local,25,IMB\IMBMediatelMail,k2Ve=8asWa7UDrA,IMBMediatelMail@platinumbank.com.ua,SalaryProjectSupport@platinumbank.com.ua,,VIP_CallBack,EMAILBODY,0,VIP_OP
LET CONTEXT="Send_mail_VIP"
CURRENTDATETIME DATE_INSERT
LET CH=Email
LET ACTION=Sended_Client
INSERT INTO loging(MODULE,BATCH,TOKEN,QUEUE_ID,DATE_INSERT,CHANNEL,CONTEXT,CH,ACTION,DNIS,SAMPLEID,CALLTRACEID)
CONCAT filename,new_410_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_746_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
HANGUP
:MAIN
FULLPLAYAMBIENT music.vox
TRANSFERTOAGENTSYNC CC_VIP,40000,RING.VOX,NOONE
HANGUP
:WAITTHANKYOU
CONCAT filename,new_490_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GOTO MAIN
:NOONE
CONCAT filename,new_407_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_408_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_71_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_409_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_303_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
CONCAT filename,new_379_,LANG,.vox
INTERRUPTPLAY filename,,0
LET filename=
GETDIGITS 1,3,3,#
IF RESPONSE==1 GOTO SENDMAIL
GOTO MAIN

























































































































































































































































